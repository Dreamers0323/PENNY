{% extends "base.html" %}

{% block title %}Penny Assistant{% endblock %}

{% block content %}
<div class="welcome-section">
    <h1><i class="fas fa-robot"></i> Penny Assistant</h1>
    <p>Your AI financial assistant is here to help</p>
</div>

<div class="card">
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
            <div class="message penny">
                <strong>Penny:</strong> Hello {{ current_user.username }}! I'm your financial assistant. How can I help you today? You can ask me about your balance, accounts, transactions, budgets, or savings goals.
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Type your message here..." autocomplete="off">
            <button class="btn" id="sendMessageBtn"><i class="fas fa-paper-plane"></i> Send</button>
        </div>
    </div>
</div>

<div class="card">
    <h2><i class="fas fa-lightbulb"></i> Quick Questions</h2>
    <div class="quick-actions">
        <button class="btn quick-question" data-question="What's my balance?"><i class="fas fa-wallet"></i> My Balance</button>
        <button class="btn quick-question" data-question="Show my accounts"><i class="fas fa-credit-card"></i> My Accounts</button>
        <button class="btn quick-question" data-question="Recent transactions"><i class="fas fa-history"></i> Transactions</button>
        <button class="btn quick-question" data-question="My budgets"><i class="fas fa-chart-pie"></i> My Budgets</button>
        <button class="btn quick-question" data-question="My savings goals"><i class="fas fa-bullseye"></i> Savings Goals</button>
        <button class="btn quick-question" data-question="Help"><i class="fas fa-question-circle"></i> Help</button>
    </div>
</div>

<div class="card">
    <h2><i class="fas fa-chart-line"></i> Financial Overview</h2>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <div style="padding: 15px; background: #2a2a2a; border-radius: 8px;">
            <h3><i class="fas fa-wallet"></i> Total Balance</h3>
            <div class="balance">ZMW {{ "%.2f"|format(total_balance) }}</div>
        </div>
        <div style="padding: 15px; background: #2a2a2a; border-radius: 8px;">
            <h3><i class="fas fa-credit-card"></i> Accounts</h3>
            <div style="font-size: 24px; font-weight: bold;">{{ accounts|length }}</div>
        </div>
        <div style="padding: 15px; background: #2a2a2a; border-radius: 8px;">
            <h3><i class="fas fa-bullseye"></i> Savings Goals</h3>
            <div style="font-size: 24px; font-weight: bold;">{{ savings_goals|length }}</div>
        </div>
        <div style="padding: 15px; background: #2a2a2a; border-radius: 8px;">
            <h3><i class="fas fa-robot"></i> Penny Status</h3>
            <div style="color: #4caf50; font-weight: bold;">Online & Ready</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/penny.js') }}"></script>
{% endblock %}

<style>
.chat-messages {
    max-height: 400px;
    overflow-y: auto;
}

.message {
    margin-bottom: 15px;
    padding: 12px;
    border-radius: 12px;
    max-width: 80%;
}

.message.user {
    background: #bb86fc;
    color: white;
    margin-left: auto;
}

.message.penny {
    background: #2a2a2a;
    color: white;
    margin-right: auto;
}

.quick-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
}

.chat-input {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.chat-input input {
    flex: 1;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #333;
    background: #2a2a2a;
    color: white;
}
</style>
